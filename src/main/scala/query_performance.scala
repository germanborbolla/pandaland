/**
 * @author German (panda@sumologic.com)
 */

import com.sumologic.client._
import model.SearchRequest
import scala.collection.JavaConversions._

"2012-09-21 07:46:01,432 -0700 INFO  [hostId=prod-ftsearch-3] [module=STREAM] [logger=stream.scala.core.QueryManager] [thread=Thread-8561 (group:HornetQ-client-global-threads-1002347088)] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [call=InboundStreamProtocol.executeQuery] Starting stream query with sessionId=A0EA8749703360CB, customerId=000000000001980A, query=[_collector=OPIS AND _sourceCategory=OPISLogFiles AND _sourceHost=OPISEXTPROD AND _sourceName=OPIS WebException], queryId=471E59E984EDB63C, startTimestamp=1348237860000, endTimestamp=1348238760000, timeZone=timezone ignored"
"2012-09-21 07:46:02,103 -0700 INFO  [hostId=prod-ftsearch-3] [module=STREAM] [logger=stream_pipeline.scala.delegates.SearchDelegate] [thread=flush-A0EA8749703360CB] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [call=InboundStreamProtocol.executeQuery] Calling search module with sessionId=5221BDDFA8A7E9B1, customerId=104458, query=_collector=OPIS and _sourceCategory=OPISLogFiles and _sourceHost=OPISEXTPROD and _sourceName=OPIS and WebException, timeRange=1348237860000 - 1348238760000"
"2012-09-21 07:46:02,677 -0700 INFO  [hostId=prod-ftsearch-3] [module=STREAM] [logger=stream_pipeline.scala.operators.Search] [thread=Thread-8566 (group:HornetQ-client-global-threads-1002347088)] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [session=5221BDDFA8A7E9B1] [customer=000000000001980A] [call=OutboundSearchProtocol.searchFinished] [session_path=A0EA8749703360CB] Search finished, sessionId=A0EA8749703360CB"
"2012-09-21 07:46:02,841 -0700 INFO  [hostId=prod-ftsearch-3] [module=STREAM] [logger=stream.scala.session.SessionQuery] [thread=Thread-8566 (group:HornetQ-client-global-threads-1002347088)] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [session=A0EA8749703360CB] [customer=000000000001980A] [call=InboundStreamProtocol.cancelQuery] [session_path=2EBEFE0E1F7ACFAB] canceling search, sessionId=A0EA8749703360CB, customerId=000000000001980A, queryId=471E59E984EDB63C, exitCode=0, query='_collector=OPIS AND _sourceCategory=OPISLogFiles AND _sourceHost=OPISEXTPROD AND _sourceName=OPIS WebException', message='Query canceled', rangeStartTime='2012-09-21 07:31:00,000', rangeEndTime='2012-09-21 07:46:00,000', rangeDuration=900000, executionStartTime='2012-09-21 07:46:01,510', executionEndTime='2012-09-21 07:46:02,840', executionDuration=1330, rawCount=0, millisToFirstCount=-1, firstBucketEndTime='N/A', firstBucketDelta=-1, fromSavedSearch=true, savedSearchId=0000000000027248, pauseCount=0, errorCount=0, warnCount=0, queryCount=0"

"2012-09-21 07:46:02,521 -0700 INFO  [hostId=prod-cass-meta-1] [module=META] [logger=scala.interchange.session.server.ServerQueueSession] [thread=Thread-1849 (group:HornetQ-client-global-threads-1722378339)] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [session=81DF32EF9BE39B73] [customer=000000000001980A] [call=InboundMetaQueryProtocol.streamIndicesInMessageWindow] [session_path=A0EA8749703360CB/5221BDDFA8A7E9B1] streamIndicesInMessageWindow-page(sessionId: 81DF32EF9BE39B73, customerId: 104458, requestId: 8ED00E9261AFFF79, responseTime: 107, size: 11, resp: [Index id=0A1064CFC554B932, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348238434707-0A1064CFC554B932, messageStartTime=1348238427539, messageEndTime=1348238548713, count=43, name=104458-1348238434707-0A1064CFC554B932, blockIds=[-9223372036854445364, -9223372036854455074, -9223372036854460680, -9223372036854460679, -9223372036854455075, -9223372036854445368, -9223372036854445367, -9223372036854445366, -9223372036854445365, -9223372036854460682, -9223372036854460681, -9223372036854460683], receiptStartTime=1348238434701, receiptEndTime=1348238554225, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=07583504C486C4E3, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348238339010-07583504C486C4E3, messageStartTime=1348238335213, messageEndTime=1348238442081, count=60, name=104458-1348238339010-07583504C486C4E3, blockIds=[-9223372036854445368, -9223372036854450382, -9223372036854450383, -9223372036854460686, -9223372036854460685, -9223372036854445371, -9223372036854445370, -9223372036854460683], receiptStartTime=1348238339007, receiptEndTime=1348238447063, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=CA98CD589653906E, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348238314760-CA98CD589653906E, messageStartTime=1348238309539, messageEndTime=1348238430706, count=251, name=104458-1348238314760-CA98CD589653906E, blockIds=[-9223372036854455076, -9223372036854455075, -9223372036854455077, -9223372036854445368, -9223372036854450381, -9223372036854450383, -9223372036854445372, -9223372036854460686, -9223372036854445371, -9223372036854460685, -9223372036854445370, -9223372036854460687, -9223372036854445369, -9223372036854460684, -9223372036854460683], receiptStartTime=1348238314750, receiptEndTime=1348238433063, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=F1F39BBC2B11E95B, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348238194919-F1F39BBC2B11E95B, messageStartTime=1348238188476, messageEndTime=1348238307494, count=65, name=104458-1348238194919-F1F39BBC2B11E95B, blockIds=[-9223372036854460689, -9223372036854455078, -9223372036854460690, -9223372036854460691, -9223372036854455079, -9223372036854450385, -9223372036854450386, -9223372036854450387, -9223372036854450384, -9223372036854445372, -9223372036854460688, -9223372036854460687, -9223372036854445374, -9223372036854445373], receiptStartTime=1348238194910, receiptEndTime=1348238312990, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=5FD8F14C61C91736, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348238219608-5FD8F14C61C91736, messageStartTime=1348238211536, messageEndTime=1348238266086, count=25, name=104458-1348238219608-5FD8F14C61C91736, blockIds=[-9223372036854460689, -9223372036854455079, -9223372036854445373], receiptStartTime=1348238219604, receiptEndTime=1348238272067, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=51D33D65D9B2ACA4, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348238064721-51D33D65D9B2ACA4, messageStartTime=1348238059211, messageEndTime=1348238172256, count=23, name=104458-1348238064721-51D33D65D9B2ACA4, blockIds=[-9223372036854460693, -9223372036854460694, -9223372036854445377, -9223372036854455080, -9223372036854460691, -9223372036854460692, -9223372036854450388, -9223372036854450389, -9223372036854445376, -9223372036854445375], receiptStartTime=1348238064717, receiptEndTime=1348238178052, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=9402AE958B4CC1E7, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348238097740-9402AE958B4CC1E7, messageStartTime=1348238090991, messageEndTime=1348238161367, count=4, name=104458-1348238097740-9402AE958B4CC1E7, blockIds=[-9223372036854460693, -9223372036854445376, -9223372036854445375], receiptStartTime=1348238097736, receiptEndTime=1348238168133, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=48C7B713B92EF0E0, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348237936656-48C7B713B92EF0E0, messageStartTime=1348237935000, messageEndTime=1348238035693, count=12, name=104458-1348237936656-48C7B713B92EF0E0, blockIds=[-9223372036854460695, -9223372036854460696, -9223372036854445378, -9223372036854445379, -9223372036854445380, -9223372036854460697, -9223372036854450390, -9223372036854450391], receiptStartTime=1348237936651, receiptEndTime=1348238043735, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=70D11D046AE1350A, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348237941053-70D11D046AE1350A, messageStartTime=1348237939278, messageEndTime=1348238033000, count=4, name=104458-1348237941053-70D11D046AE1350A, blockIds=[-9223372036854445380, -9223372036854450390], receiptStartTime=1348237941036, receiptEndTime=1348238034651, compressed=false, payloadIncluded=false, precisionStep=4],[Index id=3ABC481296BCB419, customerId=000000000001980A, path=search.index.s3:/lucene-index/104458-1348237815675-3ABC481296BCB419, messageStartTime=1348237812459, messageEndTime=1348237932000, count=224, name=104458-1348237815675-3ABC481296BCB419, blockIds=[-9223372036854445381, -9223372036854450393, -9223372036854450394, -9223372036854445382, -9223372036854445383, -9223372036854445384, -9223372036854455082, -9223372036854455081, -9223372036854455083, -9223372036854445385, -9223372036854460698, -9223372036854450391, -9223372036854460699, -9223372036854460700, -9223372036854450392], receiptStartTime=1348237815651, receiptEndTime=1348237933650, compressed=false, payloadIncluded=false, precisionStep=4], pageStart: 1348237860000, pageEnd: 1348238460000"
"2012-09-21 07:46:02,523 -0700 INFO  [hostId=prod-cass-meta-1] [module=META] [logger=scala.interchange.session.server.ServerQueueSession] [thread=Thread-1849 (group:HornetQ-client-global-threads-1722378339)] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [session=81DF32EF9BE39B73] [customer=000000000001980A] [call=InboundMetaQueryProtocol.streamIndicesInMessageWindow] [session_path=A0EA8749703360CB/5221BDDFA8A7E9B1] streamIndicesInMessageWindow(sessionId: 81DF32EF9BE39B73, customerId: 104458, requestId: 8ED00E9261AFFF79, globalResponseTime: 265, absStart: 1348237860000, absEnd: 1348238760000"

"2012-09-21 07:46:02,672 -0700 INFO  [hostId=prod-ftsearch-4] [module=SEARCH] [logger=search.katta.KattaSearcher$MetaDataLookupCallback] [thread=MTP-SearchQueryHandler-11] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [session=5221BDDFA8A7E9B1] [customer=000000000001980A] [call=InboundSearchProtocol.startSearch] [session_path=A0EA8749703360CB] sessionID=5221BDDFA8A7E9B1, customerId=104458, startTime=1348237860000, endTime=1348238460000, messageCount=0, searchRunTime=137"

"2012-09-21 07:46:02,241 -0700 INFO  [hostId=prod-ftsearch-4] [module=SEARCH] [logger=search.katta.KattaSearcher] [thread=MTP-SearchQueryHandler-11] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [session=5221BDDFA8A7E9B1] [customer=000000000001980A] [call=InboundSearchProtocol.startSearch] [session_path=A0EA8749703360CB] Asking meta for indices in the time range 1348237860000 - 1348238760000 for sessionId=5221BDDFA8A7E9B1"

"2012-09-21 07:46:02,418 -0700 INFO  [hostId=prod-ftsearch-4] [module=SEARCH] [logger=scala.meta_client.protocol.message.IndexLookupResultStream] [thread=Thread-5064 (group:HornetQ-client-global-threads-597132817)] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [session=81DF32EF9BE39B73] [customer=000000000001980A] [call=OutboundMetaQueryProtocol.indicesPage] [session_path=A0EA8749703360CB/5221BDDFA8A7E9B1] Received a batch of indices, count=4, startTime=1348238460000, endTime=1348238760000 for sessionId=81DF32EF9BE39B73, requestId=8ED00E9261AFFF79"

"2012-09-21 07:46:02,529 -0700 INFO  [hostId=prod-ftsearch-4] [module=SEARCH] [logger=scala.meta_client.protocol.message.IndexLookupResultStream] [thread=Thread-5064 (group:HornetQ-client-global-threads-597132817)] [auth=User:john.hildebrant@wizards.com:000000000001981E:000000000001980A:false] [session=81DF32EF9BE39B73] [customer=000000000001980A] [call=OutboundMetaQueryProtocol.requestDone] [session_path=A0EA8749703360CB/5221BDDFA8A7E9B1] Finished receiving all batches of indices from meta for sessionId=81DF32EF9BE39B73, requestId=8ED00E9261AFFF79"
val FindSessionQuery = "_sourcecategory=stream SessionQuery %s"

val sessionId = args(1)
val credentials = new ConfigurationCredentials(args(0))

val client = new SumoLogicClient(credentials)

val response = client.search(new SearchRequest(FindSessionQuery.format(sessionId)))

val message = response.getMessages.head
val executionTime = message.longField("executionTime")
val 
